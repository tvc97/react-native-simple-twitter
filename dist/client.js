import Request from './request';
import * as Util from './util';
import CustomError from './error';
const baseURL = 'https://api.twitter.com';
const apiURL = 'https://api.twitter.com/1.1';
const uploadURL = 'https://upload.twitter.com/1.1';
const requestTokenURL = '/oauth/request_token';
const authorizationURL = '/oauth/authorize';
const accessTokenURL = '/oauth/access_token';
class Client {
    constructor() {
        this.TokenRequestHeaderParams = {};
        this.setConsumerKey = (consumerKey, consumerSecret) => {
            this.ConsumerKey = consumerKey;
            this.ConsumerSecret = consumerSecret;
        };
        this.setAccessToken = (token, tokenSecret) => {
            this.Token = token;
            this.TokenSecret = tokenSecret;
        };
        this.getLoginUrl = async (callback = '') => {
            this.TokenRequestHeaderParams = Util.createTokenRequestHeaderParams(this.ConsumerKey, { callback });
            this.TokenRequestHeaderParams = Util.createSignature(this.TokenRequestHeaderParams, 'POST', baseURL + requestTokenURL, this.ConsumerSecret);
            const result = await Request('POST', baseURL + requestTokenURL, this.TokenRequestHeaderParams);
            if ('errors' in result) {
                throw new CustomError(result);
            }
            this.setAccessToken(result.oauth_token, result.oauth_token_secret);
            return `${baseURL + authorizationURL}?oauth_token=${this.Token}`;
        };
        this.getAccessToken = async (verifier = '') => {
            this.TokenRequestHeaderParams = Util.createTokenRequestHeaderParams(this.ConsumerKey, { token: this.Token });
            this.TokenRequestHeaderParams = Util.createSignature(this.TokenRequestHeaderParams, 'POST', baseURL + accessTokenURL, this.ConsumerSecret, this.TokenSecret);
            this.TokenRequestHeaderParams.oauth_verifier = verifier;
            const result = await Request('POST', baseURL + accessTokenURL, this.TokenRequestHeaderParams);
            if ('errors' in result) {
                throw new CustomError(result);
            }
            this.setAccessToken(result.oauth_token, result.oauth_token_secret);
            return {
                oauth_token: result.oauth_token,
                oauth_token_secret: result.oauth_token_secret,
            };
        };
        this.api = async (method, endpoint, params = {}) => {
            const apiEndpoint = endpoint.slice(0, 1) !== '/' ? `/${endpoint}` : endpoint;
            const _apiURL = /upload/i.test(endpoint) ? uploadURL : apiURL;
            this.TokenRequestHeaderParams = Util.createTokenRequestHeaderParams(this.ConsumerKey, { token: this.Token, params });
            this.TokenRequestHeaderParams = Util.createSignature(this.TokenRequestHeaderParams, method, _apiURL + apiEndpoint, this.ConsumerSecret, this.TokenSecret);
            const result = await Request(method, _apiURL +
                (params
                    ? `${apiEndpoint}?${Util.encodeParamsToString(params)}`
                    : apiEndpoint), this.TokenRequestHeaderParams);
            if ('errors' in result) {
                throw new CustomError(result);
            }
            return result;
        };
        this.post = async (endpoint, params = {}) => {
            const result = await this.api('POST', endpoint, params);
            return result;
        };
        this.get = async (endpoint, params = {}) => {
            const result = await this.api('GET', endpoint, params);
            return result;
        };
    }
}
export default new Client();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NsaWVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLE9BQU8sTUFBTSxXQUFXLENBQUM7QUFDaEMsT0FBTyxLQUFLLElBQUksTUFBTSxRQUFRLENBQUM7QUFPL0IsT0FBTyxXQUFXLE1BQU0sU0FBUyxDQUFDO0FBR2xDLE1BQU0sT0FBTyxHQUFXLHlCQUF5QixDQUFDO0FBQ2xELE1BQU0sTUFBTSxHQUFXLDZCQUE2QixDQUFDO0FBQ3JELE1BQU0sU0FBUyxHQUFXLGdDQUFnQyxDQUFDO0FBQzNELE1BQU0sZUFBZSxHQUFXLHNCQUFzQixDQUFDO0FBQ3ZELE1BQU0sZ0JBQWdCLEdBQVcsa0JBQWtCLENBQUM7QUFDcEQsTUFBTSxjQUFjLEdBQVcscUJBQXFCLENBQUM7QUFFckQsTUFBTSxNQUFNO0lBQVo7UUFTRSw2QkFBd0IsR0FBUSxFQUFFLENBQUM7UUFLbkMsbUJBQWMsR0FBRyxDQUFDLFdBQW1CLEVBQUUsY0FBc0IsRUFBUSxFQUFFO1lBQ3JFLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1lBQy9CLElBQUksQ0FBQyxjQUFjLEdBQUcsY0FBYyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQztRQUtGLG1CQUFjLEdBQUcsQ0FBQyxLQUFhLEVBQUUsV0FBbUIsRUFBUSxFQUFFO1lBQzVELElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1lBQ25CLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1FBQ2pDLENBQUMsQ0FBQztRQUtGLGdCQUFXLEdBQUcsS0FBSyxFQUFFLFdBQW1CLEVBQUUsRUFBbUIsRUFBRTtZQUM3RCxJQUFJLENBQUMsd0JBQXdCLEdBQUcsSUFBSSxDQUFDLDhCQUE4QixDQUNqRSxJQUFJLENBQUMsV0FBVyxFQUNoQixFQUFFLFFBQVEsRUFBRSxDQUNiLENBQUM7WUFDRixJQUFJLENBQUMsd0JBQXdCLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FDbEQsSUFBSSxDQUFDLHdCQUF3QixFQUM3QixNQUFNLEVBQ04sT0FBTyxHQUFHLGVBQWUsRUFDekIsSUFBSSxDQUFDLGNBQWMsQ0FDcEIsQ0FBQztZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sT0FBTyxDQUMxQixNQUFNLEVBQ04sT0FBTyxHQUFHLGVBQWUsRUFDekIsSUFBSSxDQUFDLHdCQUF3QixDQUM5QixDQUFDO1lBRUYsSUFBSSxRQUFRLElBQUksTUFBTSxFQUFFO2dCQUN0QixNQUFNLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQy9CO1lBRUQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBRW5FLE9BQU8sR0FBRyxPQUFPLEdBQUcsZ0JBQWdCLGdCQUFnQixJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDbkUsQ0FBQyxDQUFDO1FBS0YsbUJBQWMsR0FBRyxLQUFLLEVBQUUsV0FBbUIsRUFBRSxFQUF3QixFQUFFO1lBQ3JFLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxJQUFJLENBQUMsOEJBQThCLENBQ2pFLElBQUksQ0FBQyxXQUFXLEVBQ2hCLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FDdEIsQ0FBQztZQUNGLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUNsRCxJQUFJLENBQUMsd0JBQXdCLEVBQzdCLE1BQU0sRUFDTixPQUFPLEdBQUcsY0FBYyxFQUN4QixJQUFJLENBQUMsY0FBYyxFQUNuQixJQUFJLENBQUMsV0FBVyxDQUNqQixDQUFDO1lBQ0YsSUFBSSxDQUFDLHdCQUF3QixDQUFDLGNBQWMsR0FBRyxRQUFRLENBQUM7WUFFeEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxPQUFPLENBQzFCLE1BQU0sRUFDTixPQUFPLEdBQUcsY0FBYyxFQUN4QixJQUFJLENBQUMsd0JBQXdCLENBQzlCLENBQUM7WUFFRixJQUFJLFFBQVEsSUFBSSxNQUFNLEVBQUU7Z0JBQ3RCLE1BQU0sSUFBSSxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDL0I7WUFFRCxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsTUFBTSxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFFbkUsT0FBTztnQkFDTCxXQUFXLEVBQUUsTUFBTSxDQUFDLFdBQVc7Z0JBQy9CLGtCQUFrQixFQUFFLE1BQU0sQ0FBQyxrQkFBa0I7YUFDOUMsQ0FBQztRQUNKLENBQUMsQ0FBQztRQUtGLFFBQUcsR0FBRyxLQUFLLEVBQ1QsTUFBYyxFQUNkLFFBQWdCLEVBQ2hCLFNBQWMsRUFBRSxFQUNKLEVBQUU7WUFDZCxNQUFNLFdBQVcsR0FDZixRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztZQUMzRCxNQUFNLE9BQU8sR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztZQUU5RCxJQUFJLENBQUMsd0JBQXdCLEdBQUcsSUFBSSxDQUFDLDhCQUE4QixDQUNqRSxJQUFJLENBQUMsV0FBVyxFQUNoQixFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUM5QixDQUFDO1lBQ0YsSUFBSSxDQUFDLHdCQUF3QixHQUFHLElBQUksQ0FBQyxlQUFlLENBQ2xELElBQUksQ0FBQyx3QkFBd0IsRUFDN0IsTUFBTSxFQUNOLE9BQU8sR0FBRyxXQUFXLEVBQ3JCLElBQUksQ0FBQyxjQUFjLEVBQ25CLElBQUksQ0FBQyxXQUFXLENBQ2pCLENBQUM7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLE9BQU8sQ0FDMUIsTUFBTSxFQUNOLE9BQU87Z0JBQ0wsQ0FBQyxNQUFNO29CQUNMLENBQUMsQ0FBQyxHQUFHLFdBQVcsSUFBSSxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxDQUFDLEVBQUU7b0JBQ3ZELENBQUMsQ0FBQyxXQUFXLENBQUMsRUFDbEIsSUFBSSxDQUFDLHdCQUF3QixDQUM5QixDQUFDO1lBRUYsSUFBSSxRQUFRLElBQUksTUFBTSxFQUFFO2dCQUN0QixNQUFNLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQy9CO1lBRUQsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQyxDQUFDO1FBTUYsU0FBSSxHQUFHLEtBQUssRUFBRSxRQUFnQixFQUFFLFNBQWMsRUFBRSxFQUFnQixFQUFFO1lBQ2hFLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBRXhELE9BQU8sTUFBTSxDQUFDO1FBQ2hCLENBQUMsQ0FBQztRQU1GLFFBQUcsR0FBRyxLQUFLLEVBQUUsUUFBZ0IsRUFBRSxTQUFjLEVBQUUsRUFBZ0IsRUFBRTtZQUMvRCxNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUV2RCxPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDLENBQUM7SUFDSixDQUFDO0NBQUE7QUFFRCxlQUFlLElBQUksTUFBTSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBsaWIgKi9cbmltcG9ydCBSZXF1ZXN0IGZyb20gJy4vcmVxdWVzdCc7XG5pbXBvcnQgKiBhcyBVdGlsIGZyb20gJy4vdXRpbCc7XG5pbXBvcnQge1xuICBNZXRob2QsXG4gIFJlcXVlc3RUb2tlblJlc3BvbnNlLFxuICBBY2Nlc3NUb2tlblJlc3BvbnNlLFxuICBBY2Nlc3NUb2tlbixcbn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgQ3VzdG9tRXJyb3IgZnJvbSAnLi9lcnJvcic7XG5cbi8qIGNvbnN0ICovXG5jb25zdCBiYXNlVVJMOiBzdHJpbmcgPSAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20nO1xuY29uc3QgYXBpVVJMOiBzdHJpbmcgPSAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vMS4xJztcbmNvbnN0IHVwbG9hZFVSTDogc3RyaW5nID0gJ2h0dHBzOi8vdXBsb2FkLnR3aXR0ZXIuY29tLzEuMSc7XG5jb25zdCByZXF1ZXN0VG9rZW5VUkw6IHN0cmluZyA9ICcvb2F1dGgvcmVxdWVzdF90b2tlbic7XG5jb25zdCBhdXRob3JpemF0aW9uVVJMOiBzdHJpbmcgPSAnL29hdXRoL2F1dGhvcml6ZSc7XG5jb25zdCBhY2Nlc3NUb2tlblVSTDogc3RyaW5nID0gJy9vYXV0aC9hY2Nlc3NfdG9rZW4nO1xuXG5jbGFzcyBDbGllbnQge1xuICBDb25zdW1lcktleSE6IHN0cmluZztcblxuICBDb25zdW1lclNlY3JldCE6IHN0cmluZztcblxuICBUb2tlbiE6IHN0cmluZztcblxuICBUb2tlblNlY3JldCE6IHN0cmluZztcblxuICBUb2tlblJlcXVlc3RIZWFkZXJQYXJhbXM6IGFueSA9IHt9O1xuXG4gIC8qKlxuICAgKiBzZXQgY29uc3VtZXJcbiAgICovXG4gIHNldENvbnN1bWVyS2V5ID0gKGNvbnN1bWVyS2V5OiBzdHJpbmcsIGNvbnN1bWVyU2VjcmV0OiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgICB0aGlzLkNvbnN1bWVyS2V5ID0gY29uc3VtZXJLZXk7XG4gICAgdGhpcy5Db25zdW1lclNlY3JldCA9IGNvbnN1bWVyU2VjcmV0O1xuICB9O1xuXG4gIC8qKlxuICAgKiBzZXQgYWNjZXNzIHRva2VuXG4gICAqL1xuICBzZXRBY2Nlc3NUb2tlbiA9ICh0b2tlbjogc3RyaW5nLCB0b2tlblNlY3JldDogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgdGhpcy5Ub2tlbiA9IHRva2VuO1xuICAgIHRoaXMuVG9rZW5TZWNyZXQgPSB0b2tlblNlY3JldDtcbiAgfTtcblxuICAvKipcbiAgICogZ2V0IGxvZ2luIHJlZGlyZWN0IHVybFxuICAgKi9cbiAgZ2V0TG9naW5VcmwgPSBhc3luYyAoY2FsbGJhY2s6IHN0cmluZyA9ICcnKTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcyA9IFV0aWwuY3JlYXRlVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zKFxuICAgICAgdGhpcy5Db25zdW1lcktleSxcbiAgICAgIHsgY2FsbGJhY2sgfVxuICAgICk7XG4gICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMgPSBVdGlsLmNyZWF0ZVNpZ25hdHVyZShcbiAgICAgIHRoaXMuVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zLFxuICAgICAgJ1BPU1QnLFxuICAgICAgYmFzZVVSTCArIHJlcXVlc3RUb2tlblVSTCxcbiAgICAgIHRoaXMuQ29uc3VtZXJTZWNyZXRcbiAgICApO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUmVxdWVzdDxSZXF1ZXN0VG9rZW5SZXNwb25zZT4oXG4gICAgICAnUE9TVCcsXG4gICAgICBiYXNlVVJMICsgcmVxdWVzdFRva2VuVVJMLFxuICAgICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXNcbiAgICApO1xuXG4gICAgaWYgKCdlcnJvcnMnIGluIHJlc3VsdCkge1xuICAgICAgdGhyb3cgbmV3IEN1c3RvbUVycm9yKHJlc3VsdCk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRBY2Nlc3NUb2tlbihyZXN1bHQub2F1dGhfdG9rZW4sIHJlc3VsdC5vYXV0aF90b2tlbl9zZWNyZXQpO1xuXG4gICAgcmV0dXJuIGAke2Jhc2VVUkwgKyBhdXRob3JpemF0aW9uVVJMfT9vYXV0aF90b2tlbj0ke3RoaXMuVG9rZW59YDtcbiAgfTtcblxuICAvKipcbiAgICogZ2V0IGFjY2VzcyB0b2tlblxuICAgKi9cbiAgZ2V0QWNjZXNzVG9rZW4gPSBhc3luYyAodmVyaWZpZXI6IHN0cmluZyA9ICcnKTogUHJvbWlzZTxBY2Nlc3NUb2tlbj4gPT4ge1xuICAgIHRoaXMuVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zID0gVXRpbC5jcmVhdGVUb2tlblJlcXVlc3RIZWFkZXJQYXJhbXMoXG4gICAgICB0aGlzLkNvbnN1bWVyS2V5LFxuICAgICAgeyB0b2tlbjogdGhpcy5Ub2tlbiB9XG4gICAgKTtcbiAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcyA9IFV0aWwuY3JlYXRlU2lnbmF0dXJlKFxuICAgICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMsXG4gICAgICAnUE9TVCcsXG4gICAgICBiYXNlVVJMICsgYWNjZXNzVG9rZW5VUkwsXG4gICAgICB0aGlzLkNvbnN1bWVyU2VjcmV0LFxuICAgICAgdGhpcy5Ub2tlblNlY3JldFxuICAgICk7XG4gICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMub2F1dGhfdmVyaWZpZXIgPSB2ZXJpZmllcjtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFJlcXVlc3Q8QWNjZXNzVG9rZW5SZXNwb25zZT4oXG4gICAgICAnUE9TVCcsXG4gICAgICBiYXNlVVJMICsgYWNjZXNzVG9rZW5VUkwsXG4gICAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtc1xuICAgICk7XG5cbiAgICBpZiAoJ2Vycm9ycycgaW4gcmVzdWx0KSB7XG4gICAgICB0aHJvdyBuZXcgQ3VzdG9tRXJyb3IocmVzdWx0KTtcbiAgICB9XG5cbiAgICB0aGlzLnNldEFjY2Vzc1Rva2VuKHJlc3VsdC5vYXV0aF90b2tlbiwgcmVzdWx0Lm9hdXRoX3Rva2VuX3NlY3JldCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgb2F1dGhfdG9rZW46IHJlc3VsdC5vYXV0aF90b2tlbixcbiAgICAgIG9hdXRoX3Rva2VuX3NlY3JldDogcmVzdWx0Lm9hdXRoX3Rva2VuX3NlY3JldCxcbiAgICB9O1xuICB9O1xuXG4gIC8qKlxuICAgKiBjYWxsIFR3aXR0ZXIgQXBpXG4gICAqL1xuICBhcGkgPSBhc3luYyA8VD4oXG4gICAgbWV0aG9kOiBNZXRob2QsXG4gICAgZW5kcG9pbnQ6IHN0cmluZyxcbiAgICBwYXJhbXM6IGFueSA9IHt9XG4gICk6IFByb21pc2U8VD4gPT4ge1xuICAgIGNvbnN0IGFwaUVuZHBvaW50ID1cbiAgICAgIGVuZHBvaW50LnNsaWNlKDAsIDEpICE9PSAnLycgPyBgLyR7ZW5kcG9pbnR9YCA6IGVuZHBvaW50O1xuICAgIGNvbnN0IF9hcGlVUkwgPSAvdXBsb2FkL2kudGVzdChlbmRwb2ludCkgPyB1cGxvYWRVUkwgOiBhcGlVUkw7XG5cbiAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcyA9IFV0aWwuY3JlYXRlVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zKFxuICAgICAgdGhpcy5Db25zdW1lcktleSxcbiAgICAgIHsgdG9rZW46IHRoaXMuVG9rZW4sIHBhcmFtcyB9XG4gICAgKTtcbiAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcyA9IFV0aWwuY3JlYXRlU2lnbmF0dXJlKFxuICAgICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMsXG4gICAgICBtZXRob2QsXG4gICAgICBfYXBpVVJMICsgYXBpRW5kcG9pbnQsXG4gICAgICB0aGlzLkNvbnN1bWVyU2VjcmV0LFxuICAgICAgdGhpcy5Ub2tlblNlY3JldFxuICAgICk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBSZXF1ZXN0PFQ+KFxuICAgICAgbWV0aG9kLFxuICAgICAgX2FwaVVSTCArXG4gICAgICAgIChwYXJhbXNcbiAgICAgICAgICA/IGAke2FwaUVuZHBvaW50fT8ke1V0aWwuZW5jb2RlUGFyYW1zVG9TdHJpbmcocGFyYW1zKX1gXG4gICAgICAgICAgOiBhcGlFbmRwb2ludCksXG4gICAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtc1xuICAgICk7XG5cbiAgICBpZiAoJ2Vycm9ycycgaW4gcmVzdWx0KSB7XG4gICAgICB0aHJvdyBuZXcgQ3VzdG9tRXJyb3IocmVzdWx0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8qKlxuICAgKiBhcGkoXCJQT1NUXCIsZW5kcG9pbnQscGFyYW1zKSBhbGlhc1xuICAgKiB3aWxsIGJlIHJlbW92ZSBhdCBuZXh0IHZlcnNpb25cbiAgICovXG4gIHBvc3QgPSBhc3luYyAoZW5kcG9pbnQ6IHN0cmluZywgcGFyYW1zOiBhbnkgPSB7fSk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcGkoJ1BPU1QnLCBlbmRwb2ludCwgcGFyYW1zKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLyoqXG4gICAqIGFwaShcIkdFVFwiLGVuZHBvaW50LHBhcmFtcykgYWxpYXNcbiAgICogd2lsbCBiZSByZW1vdmUgYXQgbmV4dCB2ZXJzaW9uXG4gICAqL1xuICBnZXQgPSBhc3luYyAoZW5kcG9pbnQ6IHN0cmluZywgcGFyYW1zOiBhbnkgPSB7fSk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcGkoJ0dFVCcsIGVuZHBvaW50LCBwYXJhbXMpO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IENsaWVudCgpO1xuIl19